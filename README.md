# 通义千问文本生成字段捷径

这是一个基于飞书字段捷径的通义千问文本生成工具，使用 OpenAI SDK 调用阿里云 DashScope API。

## 功能特性

- ✨ **文本生成**：使用通义千问大模型进行智能文本生成
- 🖼️ **图片识别**：支持图片URL输入，自动识别并分析图片内容
- 🧠 **深度思考**：支持深度思考模式，提供更周详的回答
- 🚀 **多模型支持**：支持 Qwen Turbo、Plus、Max、Long、VL 系列等多种模型
- 🌍 **多语言支持**：支持中文、英文、日文界面
- ⚡ **高性能**：使用 OpenAI SDK 优化调用性能

## 使用方法

### 1. 基本使用流程

1. **选择模型**：从下拉列表中选择合适的通义千问模型
2. **输入 API Key**：输入您的 DashScope API Key（必填）
3. **输入内容**：输入您的问题或要求（必填）
4. **获取回复**：系统会返回 AI 生成的回复和响应时间

### 2. 参数说明

- **模型选择**（可选）
  - 默认为 Qwen Plus，适合大多数场景
  - 可根据需要选择其他模型

- **API Key**（必填）
  - 需要从阿里云 DashScope 控制台获取

- **输入提示**（必填）
  - 最多支持 2000 个字符
  - 可以是问题、指令或任何文本内容

- **深度思考模式**（可选）
  - 启用后模型会在回答前进行深入思考
  - 适合处理复杂问题，提供更周详的回答
  - 可能会增加响应时间

### 3. 使用示例

**场景1：日常问答**
- 模型：Qwen Plus
- Prompt：请解释什么是人工智能

**场景2：文案创作**
- 模型：Qwen Max
- Prompt：请为一款新的咖啡写一段宣传文案

**场景3：长文本处理**
- 模型：Qwen Long
- Prompt：请总结这篇长篇文章的主要内容...

**场景4：深度思考（复杂问题）**
- 模型：Qwen Max
- 启用深度思考模式：开启
- Prompt：请分析人工智能对未来10年教育领域的影响，并提出具体建议

**场景5：图片识别**
- 模型：Qwen3-VL-Flash
- Prompt：请分析这张图片的内容：https://img.alicdn.com/imgextra/i1/O1CN01gDEY8M1W114Hi3XcN_!!6000000002727-0-tps-1024-406.jpg 这是什么数学问题？

**场景6：图片+深度思考**
- 模型：Qwen3-VL-Plus
- 启用深度思考模式：开启
- Prompt：请详细解答图中的题目，并给出解题步骤：https://img.alicdn.com/tfs/TB1X...jpg

## 支持的模型

- **Qwen Turbo** - 快速响应，适合日常对话
- **Qwen Plus** - 均衡性能，适合大多数场景（默认）
- **Qwen Max** - 最强性能，适合复杂任务
- **Qwen Long** - 长文本处理，支持超长上下文
- **Qwen3-VL-Plus** - 视觉语言模型，支持图片理解
- **Qwen3-VL-Flash** - Qwen3系列小尺寸视觉理解模型，支持思考模式与视觉理解

## 技术架构

```
src/
├── index.ts              # 主入口文件
└── services/             # 服务层
    └── textGeneration.ts # 文本生成服务
```

- **服务层设计**：文本生成功能封装在独立的服务类中，便于维护和扩展
- **OpenAI SDK**：使用 OpenAI SDK 调用通义千问 API，提供统一的接口体验

## API Key获取
1. 访问阿里云DashScope控制台
2. 开通服务并获取API Key
3. 将API Key输入到快捷字段中

## 注意事项

1. **API Key 安全**：请妥善保管您的 DashScope API Key，系统不会存储在日志中
2. **调用限制**：请注意 API 的调用频率和配额限制
3. **模型选择**：
   - 文本任务可选择 Qwen Turbo/Plus/Max/Long
   - 图片识别任务必须选择 VL 系列模型（Qwen3-VL-Plus 或 Qwen3-VL-Flash）
4. **输入长度**：Prompt 最多支持 2000 个字符
5. **图片格式**：支持 JPG、JPEG、PNG、GIF、BMP、WebP、SVG 等格式
6. **图片识别**：
   - 只需要输入图片URL，系统会自动提取并识别
   - 支持的图片域名包括 img.alicdn.com、image、pic、photo 等
   - 非VL模型会忽略图片，仅处理文本内容

## 错误处理

系统会返回详细的错误信息，包括：
- API 请求失败
- 参数验证错误
- 生成超时
- 其他异常情况

所有错误都会在返回结果的 `response` 字段中显示。